# 束水攻沙演示项目

## 项目简介

本项目是一个基于Ursina引擎开发的适用于辅助教学（特别是人教版7年级上册地理教科书-束水攻沙）的模拟演示程序，旨在直观展示"束水攻沙"这一传统水利工程原理。程序通过3D可视化方式模拟河流流动及泥沙沉积过程，用户可调节河宽、河高和泥沙量等参数，观察不同条件下的水流与泥沙运动规律。

## 功能特点

- 交互式参数设置界面，支持调整河宽、河高和泥沙量
- 3D可视化展示河流流动效果
- 动态模拟泥沙随水流移动和沉积的过程
- 第一人称视角，可在场景中自由移动观察
- 实时显示当前模拟参数和状态信息

## 技术栈

- Python 3.x
- Ursina引擎（用于3D渲染和交互）
- Tkinter（用于参数设置界面）

## 安装步骤

1. 确保已安装Python 3.x环境

2. 安装必要的依赖包：
   ```bash
   pip install ursina
   ```

3. 克隆或下载本项目到本地

## 使用说明

1. 运行主程序：
   ```bash
   python main.py
   ```

2. 在弹出的参数设置界面中，设置所需的参数：
   - **河宽**：1-6之间的整数
   - **河高**：1-6之间的整数
   - **泥沙量**：1-100之间的整数
   
   可通过滑块或直接输入数值进行调整，点击"确定"按钮开始模拟。

3. 在3D场景中，使用以下控制方式：
   - **P键**：开始模拟
   - **WASD键**：前后左右移动
   - **鼠标**：控制视角
   - **空格键**：上升
   - **Shift键**：下降

## 项目结构

```
i:\py\束水攻沙\
├── main.py          # 主程序文件
├── water_still.gif  # 水流动画资源
├── water_still.png  # 水静止图像资源
└── README.md        # 项目说明文档
```

## 实现原理

程序基于以下物理原理进行模拟：

1. **水流模拟**：通过Ursina的Animation和自定义的water类实现水流的视觉效果和运动轨迹

2. **泥沙运动**：通过sand类模拟泥沙颗粒随水流移动的过程，包括随机生成初始位置和沿水流方向移动

3. **参数影响**：
   - 河宽和河高影响水流速度（公式：v = int(900 / (Global.width * Global.height) / 7 // 1)+1）*
   - 水流流速影响泥沙运动速度（公式：v_sand = int(v ** 3/20//1)+1）**
   - 泥沙量影响模拟中参与运动的泥沙颗粒数量

*注：公式中的900为流量，来源于人教版7年级上册地理教科书假定值。公式中的7是一个经验值，用于调整水流速度与河宽、河高的关系。

**注：以上公式来源于某搜索引擎的`根据水力学原理，水流的挟沙能力与流速的高次方（通常为3-4次方）成正比。`此外，公式中的20是一个经验值，用于调整泥沙运动速度与水流速度的关系。

以上两个公式的`//1` 用于取整，`+1` 用于确保运动速度至少为1。

## 注意事项

- 由于Ursina引擎的限制，部分UI元素可能会以英文显示
- 模拟过程中，当泥沙量消耗完毕后，模拟将自动停止
- 程序运行可能需要一定的硬件性能，特别是在较高参数设置下

## 开发背景

"束水攻沙"是中国古代水利工程中的重要原理，通过束窄河道来增加水流速度，利用水流的力量冲刷泥沙，从而达到治理河道淤积的目的。本项目通过现代计算机技术，将这一传统水利智慧以可视化方式呈现出来，有助于理解和传承这一古老的工程思想。

## License

[Apache-2.0](http://www.apache.org/licenses/)

## 致谢

- Ursina引擎开发团队
- 中国古代水利工程研究者
- 我的地理老师
        